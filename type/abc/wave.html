<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="stylesheet" href="css/wave.css">
</head>


<body onload="initialize()">
    <div id="demo">
        <div id="text"></div>
        <!-- <input id="control" class="slider" type="range"> -->
    </div>
    
</body>

<script>
  // var text = "Propagating information through text"
  var text = "Bouncing ideas back and forth"
  // var text = "Coffee, coffee. I need some more COFFEE!"
  // var text = "Mix & Match Weights"
  function initialize(){

    var demoDiv = document.getElementById('text')
    for (var i = 0; i < text.length; i++) {
      var charSpan = document.createElement('span')
      charSpan.setAttribute('id', 'char' + i)
      charSpan.innerHTML = text.charAt(i)
      demoDiv.appendChild(charSpan)
    }

    // var centerChar = text.length / 2
    // moveTarget(text, centerChar)

    // var slider = document.getElementById('control')
    // slider.setAttribute('min', 0)
    // slider.setAttribute('max', text.length - 1)
    // slider.value = centerChar
    // slider.oninput = function() {
    //   moveTarget(text, this.value)
    // }

    // setInterval(propagate, 75)
    setInterval(bounce, 60)
    // setInterval(jitter, 100)
  }

  function propagate() {
    centerChar = (centerChar + 1) % text.length

    centerChar = centerChar + step
    moveTarget(text, centerChar)
  }

  var step = 1
  var centerChar = 0
  function bounce() {
    if (centerChar >= text.length - 1) {
        step = -1;
    }
    if (centerChar <= 0) {
        step = 1;
    }

    centerChar = centerChar + step
    moveTarget(text, centerChar)
  }

  const weights = [0, 100, 200, 300, 400, 500, 600]
  function jitter() {
    for (var i = 0; i < text.length; i++) {
      var charSpan = document.getElementById('char' + i)
      var newWeight = weights[Math.floor(Math.random() * weights.length)]
      var oldWeight = parseInt(charSpan.style.fontWeight)
      if (isNaN(oldWeight)) {
        oldWeight = newWeight
      }

      const alpha = 0.3
      var weight = alpha * oldWeight + (1 - alpha) * newWeight
      charSpan.style.fontWeight = weight
    }
  }

  function moveTarget(text, centerChar) {
    for (var i = 0; i < text.length; i++) {
        var charSpan = document.getElementById('char' + i)
        var distance = Math.min(Math.abs(i - centerChar), 5)
        var weight = (6 - distance) * 100
        charSpan.style.fontWeight = weight
    }
  }
</script>